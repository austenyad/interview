理解简单的一个 helloworld 程序是怎样运行的

* 在 Unix 系统上，从源文件到目标文件的转化是由 编译器驱动程序 完成的。

liux> gcc -o hello hello.c

上面，GCC 编译器读取源文件 hello.c ,并把它翻译成可执行文件 hello。这个翻译过程由四个阶段的程序（预处理、编译器、汇编器和链接器）一起构成了 编译系统（compilation system）。<img src="https://note-austen-1256667106.cos.ap-beijing.myqcloud.com/2020-05-31-162823.png" style="zoom:50%;" />

\1. 预处理阶段。预处理器（cpp）根据已字符 # 开头的命令，修改原始的 C 程序。比如 hello.c 的第一行的 #include<stdio.h> 命令告诉预处理器读取系统头文件 stdio.h 的内容，并把它直接插入程序文本中。结果就得到另一个 C 程序，通常以 .i 作为文件扩展名。

\2. 编译阶段。 编译器（ccl）将文本文件 hello.i 翻译成文本文件 hello.s，它包含一个 汇编语言程序。该程序包含 函数 main 的定义，如下所示：

<img src="https://note-austen-1256667106.cos.ap-beijing.myqcloud.com/2020-05-31-162825.png" style="zoom:50%;" />



定义中 2-7 行的每条语句都以一种 文本格式 描述了 一条低级机器语言指令。汇编语言是非常有用的，因为它为不同高级语言的不同编译器提供了通用的输入语言。例如，C 编译器 和 Fortran 编译器产生的输出文件用的都是一样的汇编语言。

\3. 汇编阶段。接下来，汇编器（as）将 hello.s 翻译成机器指令，把这些指令打包成一种叫做 可重定位目标程序（relocatable object program）的格式，并将结果保存在目标文件 hello.o 中。hello.o 文件是一个二进制文件，它包含的 17 个字节是函数 main 的指令编码。如果我们再文本文件中打开 hello.o 文件，将是一堆乱码。

4.链接阶段。请注意，hello 程序调用了 printf 函数，它是每个 C 编译器都提供的 标准 C 库的一个函数。printf 函数存在于一个名为 printf.o 的单独的预编译好了的目标文件中，而这个文件必须以某种方式合并到我们的 hello.o 程序中。连接器（ld）就负责处理这种合并。结果就得到 hello 文件，它是一个可执行目标文件（或者简称为 可执行文件），可以被加载到内存中，由系统执行。

#### 了解编译系统如何工作的益处：

\1. 优化程序性能

\2. 理解链接时出现的错误

\3. 避免安全漏洞

#### Shell 是一个命令行解释器

